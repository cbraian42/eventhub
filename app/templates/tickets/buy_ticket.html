{% extends "base.html" %} 

{% block content %}
  <div class="container mt-5 mb-5">
    <h3 class="mb-4">Comprar Entrada</h3>
    <div class="row">

    {% if form.errors %}
      <div class="alert alert-danger">
        <ul style="list-style-type: none; margin: 0; padding: 0;">
          {% for error in form.non_field_errors %}
            <li>{{ error }}</li>
          {% endfor %}
          {% for field in form %}
            {% for error in field.errors %}
              <li>{{ field.label }}: {{ error }}</li>
            {% endfor %}
          {% endfor %}
        </ul>
      </div>
    {% endif %}

    <div class="col-md-8">
      <form method="post" id="ticketForm">
        {% csrf_token %}
        {{ form.non_field_errors }}

        <div class="mb-3">
          {{ form.event.label_tag }} {{ form.event }}
        </div>

        <div class="mb-3">
          {{ form.quantity.label_tag }} {{ form.quantity }}
          <div class="form-text">Disponibles: 120 entradas</div>
        </div>

        <div class="mb-3">
          {{ form.type.label_tag }} {{ form.type }}
        </div>

        <h6 class="mt-4">Método de pago</h6>

        <div class="mb-3">
          {{ form.card_type.label_tag }} {{ form.card_type }}
        </div>

        <div class="mb-3">
          {{ form.card_number.label_tag }} {{ form.card_number }}
        </div>

        <div class="mb-3">
          <label class="form-label">Vencimiento</label>
          <div class="row col-md-6 d-flex gap-2">
            {{ form.expiry_month }}
            {{ form.expiry_year }}
          </div>
        </div>

        <div class="mb-3 mt-3">
          {{ form.card_cvv.label_tag }} {{ form.card_cvv }}
        </div>

        <div class="form-check mb-3">
          <input class="form-check-input" type="checkbox" id="terms" required>
          <label class="form-check-label" for="terms">
            Acepto los <a href="#">términos y condiciones</a> y la <a href="#">política de privacidad</a>.
          </label>
        </div>
    
        <button type="submit" class="btn btn-primary w-100" id="submitBtn" disabled>Confirmar compra</button>
      </form>
    </div>

     <div class="col-md-4">
      <div class="border p-3 rounded mb-3">
        <h6>Resumen de compra</h6>
        <p class="mb-1">Precio por entrada: <strong>$45.99</strong></p>
        <p class="mb-1">Cantidad: 1</p>
        <p class="mb-1">Subtotal: $45.99</p>
        <p class="mb-1">Impuestos (10%): $4.60</p>
        <hr>
        <p class="mb-0"><strong>Total: $50.59</strong></p>
      </div>

      <div class="border p-3 rounded bg-light">
        <h6>Información importante</h6>
        <ul class="ps-3">
          <li>Las entradas son personales e intransferibles.</li>
          <li>Puedes solicitar un reembolso hasta 48h antes del evento.</li>
          <li>Recibirás tu entrada en tu correo electrónico.</li>
          <li>Presenta tu entrada digital o impresa.</li>
        </ul>
      </div>
    </div>
  </div>
</div>

<script>
  const termsCheckbox = document.getElementById('terms');
  const submitBtn = document.getElementById('submitBtn');

  termsCheckbox.addEventListener('change', function() {
    submitBtn.disabled = !this.checked;
  });
</script>

{% endblock %}
